@model List<RealEstateSite.Models.Property>
@{
    ViewData["Title"] = "Home Page";
    Layout = "~/Views/Shared/_Layout.cshtml";
}

<style>
    @@keyframes heroEntrance {
        from {
            opacity: 0;
            transform: scale(0.96);
        }

        to {
            opacity: 1;
            transform: scale(1);
        }
    }

    .hero-header {
        position: relative;
        width: calc(100% - 40px);
        margin: 20px auto 50px auto;
        height: 650px;
        border-radius: 40px;
        overflow: hidden;
        background-color: #333;
        background-image: linear-gradient(rgba(0, 0, 0, 0.4), rgba(0, 0, 0, 0.4)), url('https://images.unsplash.com/photo-1600585154340-be6161a56a0c?ixlib=rb-4.0.3&auto=format&fit=crop&w=1920&q=80');
        background-position: center;
        background-repeat: no-repeat;
        background-size: cover;
        display: flex;
        align-items: center;
        justify-content: center;
        text-align: center;
        color: white;
        box-shadow: 0 15px 40px rgba(0,0,0,0.2);
        animation: heroEntrance 1s ease-out forwards;
    }

    .hero-content {
        width: 95%;
        max-width: 1300px;
        z-index: 10;
    }

    .filter-box {
        background-color: rgba(255, 255, 255, 0.2);
        backdrop-filter: blur(20px);
        -webkit-backdrop-filter: blur(20px);
        padding: 25px;
        border-radius: 15px;
        margin-top: 30px;
        border: 1px solid rgba(255, 255, 255, 0.4);
        box-shadow: 0 8px 32px 0 rgba(31, 38, 135, 0.5);
    }

        .filter-box .form-control, .filter-box .form-select {
            height: 50px;
            border: none;
            border-radius: 8px;
            font-size: 0.95rem;
        }

        .filter-box .btn-search {
            height: 50px;
            border-radius: 8px;
            font-weight: 700;
            text-transform: uppercase;
            background-color: #0d6efd;
            color: white;
            border: none;
            width: 100%;
            transition: all 0.3s;
        }

            .filter-box .btn-search:hover {
                background-color: #0b5ed7;
                transform: translateY(-2px);
            }

    .property-scroll-wrapper {
        display: flex;
        flex-wrap: nowrap;
        overflow-x: auto;
        gap: 25px;
        padding: 10px 5px 30px 5px;
        -webkit-overflow-scrolling: touch;
    }

        .property-scroll-wrapper::-webkit-scrollbar {
            height: 10px;
        }

        .property-scroll-wrapper::-webkit-scrollbar-track {
            background: #f1f1f1;
            border-radius: 5px;
        }

        .property-scroll-wrapper::-webkit-scrollbar-thumb {
            background: #0d6efd;
            border-radius: 5px;
        }

    .scroll-item {
        flex: 0 0 auto;
        width: 340px;
    }

    .card-img-top {
        height: 220px;
        object-fit: cover;
    }

    .faq-section .accordion-button:not(.collapsed) {
        background-color: #f0f7ff;
        color: #0d6efd;
    }

    .faq-image img {
        border-radius: 20px;
        width: 100%;
        height: 100%;
        object-fit: cover;
        min-height: 450px;
        box-shadow: 0 15px 35px rgba(0,0,0,0.1);
    }
</style>

<div class="hero-header">
    <div class="hero-content">
        <h1 class="display-3 fw-bold mb-3">Find Your Dream Home</h1>
        <p class="lead mb-4" style="font-weight: 400; opacity: 0.9;">Discover the perfect property from our exclusive listings</p>

        <div class="filter-box">
            <form method="get" asp-controller="Properties" asp-action="Index">
                <div class="row g-2 mb-2">
                    <div class="col-lg-3 col-md-6">
                        <select class="form-select" name="status">
                            <option selected value="">Status (Any)</option>
                            <option value="Sale">For Sale</option>
                            <option value="Rent">For Rent</option>
                        </select>
                    </div>
                    <div class="col-lg-3 col-md-6">
                        <select class="form-select" name="category">
                            <option selected value="">Category (All)</option>
                            <option value="Apartment">Apartment</option>
                            <option value="Villa">Villa</option>
                            <option value="Office">Office</option>
                            <option value="Land">Land</option>
                        </select>
                    </div>
                    <div class="col-lg-3 col-md-6">
                        <select class="form-select" id="citySelect" name="cities"><option selected value="">City</option></select>
                    </div>
                    <div class="col-lg-3 col-md-6">
                        <select class="form-select" id="districtSelect" name="districts" disabled><option selected value="">District</option></select>
                    </div>
                </div>

                <div class="row g-2">
                    <div class="col-lg-2 col-md-4">
                        <input type="number" class="form-control" name="minPrice" placeholder="Min Price" min="0">
                    </div>
                    <div class="col-lg-2 col-md-4">
                        <input type="number" class="form-control" name="maxPrice" placeholder="Max Price" min="0">
                    </div>
                    <div class="col-lg-4 col-md-4">
                        <select class="form-select" name="roomCounts">
                            <option selected value="">Room Count</option>
                            <option value="1+0 (Studio)">1+0 (Studio)</option>
                            <option value="1+1">1+1</option>
                            <option value="2+1">2+1</option>
                            <option value="2+2">2+2</option>
                            <option value="3+1">3+1</option>
                            <option value="3+2">3+2</option>
                            <option value="4+1">4+1</option>
                            <option value="4+2">4+2</option>
                            <option value="5+1">5+1</option>
                            <option value="5+2">5+2</option>
                            <option value="6+1">6+1</option>
                            <option value="6+2">6+2</option>
                            <option value="7+1">7+1</option>
                            <option value="7+2">7+2</option>
                            <option value="8+1">8+1</option>
                            <option value="8+2">8+2</option>
                            <option value="9+1">9+1</option>
                            <option value="9+2">9+2</option>
                            <option value="10+1">10+1</option>
                            <option value="10+2">10+2</option>
                            <option value="More than 10">More than 10</option>
                        </select>
                    </div>
                    <div class="col-lg-4 col-md-12">
                        <button type="submit" class="btn btn-search"><i class="bi bi-search me-2"></i> SEARCH PROPERTIES</button>
                    </div>
                </div>
            </form>
        </div>
    </div>
</div>

<div class="container mb-5">
    <div class="row mb-5">
        <div class="col-12 text-center mb-4">
            <h2 class="fw-bold display-6">Featured Properties</h2>
            <p class="text-muted">Latest additions to our portfolio</p>
        </div>
        <div class="col-12">
            <div class="property-scroll-wrapper">
                @if (Model != null && Model.Any())
                {
                    @foreach (var item in Model)
                    {
                        <div class="scroll-item">
                            <div class="card h-100 shadow-sm border-0">
                                <a href="/Properties/Details/@item.Id" style="text-decoration: none; color: inherit;">
                                    @if (!string.IsNullOrEmpty(item.ImageUrl))
                                    {
                                        <img src="@item.ImageUrl" class="card-img-top" alt="@item.Title">
                                    }
                                    else
                                    {

                                        <div class="d-flex align-items-center justify-content-center bg-light card-img-top"><i class="bi bi-camera-fill fa-3x text-muted"></i></div>
                                    }

                                    <div class="card-body d-flex flex-column">
                                        <h5 class="card-title fw-bold text-dark text-truncate">@item.Title</h5>
                                        <p class="card-text text-muted small"><i class="bi bi-geo-alt-fill text-primary me-1"></i> @item.City, @item.District</p>
                                        <div class="mt-auto d-flex justify-content-between align-items-center pt-3 border-top">
                                            <span class="text-primary fw-bold fs-5">@((item.Price ?? 0).ToString("N0")) ₺</span>
                                            <span class="btn btn-outline-dark btn-sm rounded-pill px-4">Details</span>
                                        </div>
                                    </div>
                                </a>
                            </div>
                        </div>
                    }
                }
                else
                {
                    <div class="alert alert-warning w-100 text-center">No featured properties found.</div>
                }
            </div>
        </div>
    </div>

    <div class="row mb-5 pt-4">
        <div class="col-12 text-center mb-5">
            <h2 class="fw-bold display-6">What Our Clients Say</h2>
            <p class="text-muted">Real feedback from Google Reviews</p>
        </div>
        <div class="col-md-4 mb-4">
            <div class="card h-100 border-0 shadow-sm p-4">
                <div class="d-flex align-items-center mb-3">
                    <img src="https://randomuser.me/api/portraits/men/32.jpg" class="rounded-circle me-3" width="50" alt="User">
                    <div><h6 class="mb-0 fw-bold">John Doe</h6><small class="text-muted">Purchased a Villa</small></div>
                </div>
                <div class="mb-2"><i class="bi bi-star-fill text-warning"></i><i class="bi bi-star-fill text-warning"></i><i class="bi bi-star-fill text-warning"></i><i class="bi bi-star-fill text-warning"></i><i class="bi bi-star-fill text-warning"></i></div>
                <p class="text-secondary fst-italic">"Incredible service! The team helped me find exactly what I was looking for."</p>
            </div>
        </div>
        <div class="col-md-4 mb-4">
            <div class="card h-100 border-0 shadow-sm p-4">
                <div class="d-flex align-items-center mb-3">
                    <img src="https://randomuser.me/api/portraits/women/44.jpg" class="rounded-circle me-3" width="50" alt="User">
                    <div><h6 class="mb-0 fw-bold">Sarah Smith</h6><small class="text-muted">Rented an Apartment</small></div>
                </div>
                <div class="mb-2"><i class="bi bi-star-fill text-warning"></i><i class="bi bi-star-fill text-warning"></i><i class="bi bi-star-fill text-warning"></i><i class="bi bi-star-fill text-warning"></i><i class="bi bi-star-half text-warning"></i></div>
                <p class="text-secondary fst-italic">"Very professional agents. They showed me multiple options within my budget."</p>
            </div>
        </div>
        <div class="col-md-4 mb-4">
            <div class="card h-100 border-0 shadow-sm p-4">
                <div class="d-flex align-items-center mb-3">
                    <img src="https://randomuser.me/api/portraits/men/85.jpg" class="rounded-circle me-3" width="50" alt="User">
                    <div><h6 class="mb-0 fw-bold">Michael Brown</h6><small class="text-muted">Investor</small></div>
                </div>
                <div class="mb-2"><i class="bi bi-star-fill text-warning"></i><i class="bi bi-star-fill text-warning"></i><i class="bi bi-star-fill text-warning"></i><i class="bi bi-star-fill text-warning"></i><i class="bi bi-star-fill text-warning"></i></div>
                <p class="text-secondary fst-italic">"Great portfolio options. Most reliable agency regarding prices."</p>
            </div>
        </div>
    </div>

    <div class="faq-section py-5 border-top">
        <div class="row align-items-center">
            <div class="col-lg-7 mb-4 mb-lg-0">
                <h2 class="fw-bold display-6 mb-4 text-dark">Frequently Asked Questions</h2>
                <div class="accordion" id="accordionFAQ">
                    <div class="accordion-item mb-3 border rounded shadow-sm">
                        <h2 class="accordion-header"><button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapseOne">Do I need to make an appointment to view a property?</button></h2>
                        <div id="collapseOne" class="accordion-collapse collapse show" data-bs-parent="#accordionFAQ"><div class="accordion-body text-secondary">Yes, we recommend scheduling an appointment for a private tour.</div></div>
                    </div>
                    <div class="accordion-item mb-3 border rounded shadow-sm">
                        <h2 class="accordion-header"><button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseTwo">What documents are required for buying a home?</button></h2>
                        <div id="collapseTwo" class="accordion-collapse collapse" data-bs-parent="#accordionFAQ"><div class="accordion-body text-secondary">Generally, ID/Passport, tax number, and photos are required.</div></div>
                    </div>
                </div>
            </div>
            <div class="col-lg-5 d-none d-lg-block">
                <div class="faq-image">
                    <img src="https://images.unsplash.com/photo-1556761175-5973dc0f32e7?ixlib=rb-4.0.3&auto=format&fit=crop&w=800&q=80" alt="Consultation">
                </div>
            </div>
        </div>
    </div>
</div>

<script>
    let turkeyData = [];
    const citySelect = document.getElementById('citySelect');
    const districtSelect = document.getElementById('districtSelect');

    window.onload = function() {
        const jsonUrl = '/json/data.json';
        fetch(jsonUrl)
            .then(response => { if (!response.ok) throw new Error("JSON file not found"); return response.json(); })
            .then(data => {
                turkeyData = Array.isArray(data) ? data : (data.data || []);
                loadCities();
            })
            .catch(error => { citySelect.innerHTML = '<option>Error Loading Data</option>'; });
    };

    function loadCities() {
        citySelect.innerHTML = '<option selected value="">City</option>';
        turkeyData.forEach(city => {
            let option = document.createElement('option');
            option.value = city.name;
            option.text = city.name;
            citySelect.add(option);
        });
    }

    citySelect.addEventListener('change', function() {
        districtSelect.innerHTML = '<option selected value="">District</option>';
        districtSelect.disabled = true;
        const selectedCityName = this.value;
        if (!selectedCityName) return;
        const cityData = turkeyData.find(c => c.name === selectedCityName);
        if (cityData && cityData.counties) {
            districtSelect.disabled = false;
            cityData.counties.forEach(county => {
                let option = document.createElement('option');
                option.value = county.name;
                option.text = county.name;
                districtSelect.add(option);
            });
        }
    });
</script>